package models

import "time"

type Vulnerability struct {
	ID          string    `json:"id"`
	CVE         string    `json:"cve,omitempty"`
	Title       string    `json:"title"`
	Description string    `json:"description"`
	Severity    string    `json:"severity"`
	Score       float64   `json:"score"`
	Vector      string    `json:"vector,omitempty"`
	Package     string    `json:"package"`
	Version     string    `json:"version"`
	FixedIn     string    `json:"fixed_in,omitempty"`
	References  []string  `json:"references"`
	CreatedAt   time.Time `json:"created_at"`
}

type ScanResult struct {
	ID               string          `json:"id"`
	ImageID          string          `json:"image_id"`
	ImageName        string          `json:"image_name"`
	ImageTag         string          `json:"image_tag"`
	Vulnerabilities  []Vulnerability `json:"vulnerabilities"`
	Summary          ScanSummary     `json:"summary"`
	ScannerName      string          `json:"scanner_name"`
	ScannerVersion   string          `json:"scanner_version"`
	StartedAt        time.Time       `json:"started_at"`
	CompletedAt      time.Time       `json:"completed_at"`
}

type ScanSummary struct {
	Critical int `json:"critical"`
	High     int `json:"high"`
	Medium   int `json:"medium"`
	Low      int `json:"low"`
	Total    int `json:"total"`
}